<!DOCTYPE html>

<html>
    <head>
        <title>To-do List</title>
    </head>
    <style>
        body {
            background-color: rgb(144, 22, 214);
        }
        .full-form {
            margin:auto;
            width: 20%;
            padding: 110px;
        }
        .input-class{
            padding: 10px;
        }
        .input-box{
            padding: 10px;
            border-radius: 5px;
            width: 300px;
        }
        button{
            padding: 10px;
            border-radius: 5px;
        }
        label,h1,h3 {
            color: white;
            font-family: sans-serif;
        }
        .intro-button{
            width: 176px;
        }
        .display-none {
            display: none;
        }
        .require {
            border: 3px solid red ;
        }
        .required-all-fields{
            color:white
        }

        /*dashboard*/
        .side-bar {
            height: 100%;
            width: 160px;
            position: fixed;
            z-index: 1;
            top: 0;
            left: 0;
            background-color: rgb(255, 255, 255);
            padding-top: 100px;
        }
        .side-bar a {
            padding: 15px 8px 6px 16px;
            text-decoration: none;
            font-size: 15px;
            color: #818181;
            display: block;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        a:hover{
            color: black;
        }
        .list > li{
            color: white;
        }
    </style>
    <body>
        <div class = "full-form">

            

            <form id = "signin" class="display-none">
                <div class="input-class">
                    <h1>Sign Up</h1>
                </div>
                <div class="input-class">
                    <input type = "text" placeholder="first name" class ="input-box"/>
                </div>
                <div class="input-class">
                    <input type = "text" placeholder="last name"class ="input-box"/>
                </div>
                <div class="input-class">
                    <input type = "text" placeholder="email"class ="input-box"/>
                </div>
                <div  class="input-class">
                    <input type = "password" placeholder="password "class ="input-box"/>
                </div>
                <div  class="input-class required-all-fields display-none">
                    <p>All fields are required</p>
                </div>
                <div class="input-class">
                    <input type="checkbox" id="TermOfUse" name="TermOfUse">
                    <label for="TermOfUse" >I agree to the Terms of Use</label>
                </div>
            </form>

            <form id = "login" class="display-none">
                <div class="input-class">
                    <h1>Login In</h1>
                </div>
                <div class="input-class">
                    <input type = "text" placeholder="email"class ="input-box"/>
                </div>
                <div  class="input-class">
                    <input type = "password" placeholder="password "class ="input-box"/>
                </div>
                <div  class="input-class required-all-fields display-none">
                    <p>All fields are required</p>
                </div>
                <div class="input-class">
                    <input type="checkbox" id="TermOfUseLogin" name="TermOfUse">
                    <label for="TermOfUseLogin">I agree to the Terms of Use</label>
                </div>
            </form>
            
            <div class="input-class form-button">
                <button class="login-button display-none" id="LoginButton">Log In</button>
                <button class="signin-button display-none" id="SignUpButton">Sign Up</button>
                <button class="signin-button display-none" id="BackButton">Back</button>
            </div>


            <div class="input-class intro">
                <h1>Application Form </h1>
                <button class="intro-button">Sign Up</button>
                <button class="intro-button">Log In</button>
            </div>

        
            <div id="dashboardID" class="display-none">

                <div id="no-list" class = "input-class">
                    <h1>You have no to-do List</h1>
                    <button>Create New to-do List button</button>
                </div>
    
                <div id="create-list" class="input-class">
                    <input type="text" placeholder="Title" class="input-box" maxlength="40">
                    <h3></h3>
                    <ul class="list">
                        
                    </ul>
                    
                    <input type="text" placeholder="List" class="input-box">
                    <button id="add">Add Title</button><button id="submit-todolist">Submit</button> 
                </div>

                <!--SIDE BAR-->
                <div class="side-bar">
                    <a href=""> To-Do Lists</a>
                    <a href="">Account Settings</a>
                    <a href="">Log Out</a>
                </div>
            </div>

        </div>
    </body>
    <script>
       
            const Intro = document.querySelector('body > div > div.input-class.intro'); //intro
            const SignIntro = document.querySelector('body > div > div.input-class.intro > button:nth-child(2)'); //signup button intro
            const LogIntro = document.querySelector('body > div > div.input-class.intro > button:nth-child(3)'); //login button intro

            const SingInForm = document.getElementById('signin'); //signin form
            const LogInForm = document.getElementById('login'); //login form

            const LoginButton = document.getElementById('LoginButton'); //buttons for login
            const SignInButton = document.getElementById('SignUpButton'); //buttons for signin
            const BackButton = document.getElementById('BackButton'); //buttons for back

            const dashboard = document.getElementById("dashboardID");

            let localDB = window.localStorage;
            let sessionDB = window.sessionStorage;

            SignIntro.addEventListener("click",()=>{
                SingInForm.classList.remove('display-none')
                SignInButton.classList.remove('display-none')
                BackButton.classList.remove('display-none')
                Intro.classList.add('display-none')
                
            })
            LogIntro.addEventListener("click",()=>{
                LogInForm.classList.remove('display-none')
                LoginButton.classList.remove('display-none')
                BackButton.classList.remove('display-none')
                Intro.classList.add('display-none')
            })
            BackButton.addEventListener("click",()=>{
                SingInForm.classList.add('display-none')
                SignInButton.classList.add('display-none')
                LogInForm.classList.add('display-none')
                LoginButton.classList.add('display-none')
                BackButton.classList.add('display-none')
                Intro.classList.remove('display-none')
                FirstName.value = "";
                LastName.value = "";
                Email.value = "";
                Password.value = "";
                Terms.checked = false;    

                EmailLoginField.value = "";
                PasswordLoginField.value = "";
                TermsLogin.checked = false
            })
            SignInButton.addEventListener("click",SignIn);
            let FirstName = document.querySelector('#signin > div:nth-child(2) > input')
            let LastName = document.querySelector('#signin > div:nth-child(3) > input')
            let Email = document.querySelector('#signin > div:nth-child(4) > input')
            let Password = document.querySelector('#signin > div:nth-child(5) > input')
            let Terms = document.querySelector('#TermOfUse')
            let TextLabel = document.querySelector('#signin > div.input-class.required-all-fields.display-none')

            FirstName.addEventListener("keyup",()=>{
                FirstName.classList.remove("require")
                RemoveRequireText()
            })
            LastName.addEventListener("keyup",()=>{
                LastName.classList.remove("require")
                RemoveRequireText()
            })
            Email.addEventListener("keyup",()=>{
                Email.classList.remove("require")
                RemoveRequireText()
            })
            Password.addEventListener("keyup",()=>{
                Password.classList.remove("require")
                RemoveRequireText()
            })
            

            function SignIn(){
                let Fields= [FirstName,LastName,Email,Password,Terms]
                let check = 0
                for(var i in Fields){
                    if(Fields[i].value === ""){
                        Fields[i].classList.add("require")
                        TextLabel.classList.remove('display-none')
                        check = 1;
                    }
                }
                if(check === 0 ){
                    TextLabel.classList.remove('display-none')
                    if(Terms.checked  === true){
                        TextLabel.innerHTML = "<p>Looks Goodssss!</p>"
                        console.log(SubmitSignIn())
                    }else{
                        TextLabel.innerHTML = "<p>Terms of Use is required</p>"
                    }
                }
            }
           
            function RemoveRequireText(){
                let Fields= [FirstName,LastName,Email,Password,Terms]
                var CheckField = false;
                for(var i in Fields){
                    if(Fields[i].value === ""){
                        CheckField = true
                    }
                }
                if(CheckField === false){
                    if(Terms.checked  === false){
                        TextLabel.innerHTML = "<p>Terms of Use is required</p>"
                    }else{
                        TextLabel.innerHTML = "<p>Looks Good!</p>"
                    }
                }else if (CheckField === true){
                    TextLabel.innerHTML = "<p>All fields are required</p>"
                }
                console.log(CheckField)
            }

            function SubmitSignIn(){
                let Data = {
                    "FirstName":FirstName.value,
                    "LastName":LastName.value,
                    "Email":Email.value,
                    "Password":Password.value,
                    "Terms":Terms.checked,
                    "TodoList": []
                }
                console.log(Data)
                if(localDB.hasOwnProperty(Data.Email) === false){
                    localDB.setItem(Data.Email,JSON.stringify(Data))
                    sessionDB.setItem("user",Data.Email);
                    SessionUser(Data.Email);
                    return true;
                }else{
                    TextLabel.innerHTML = "<p>Email address already exist!</p>"
                }
            }
            
            const EmailLoginField = document.querySelector('#login > div:nth-child(2) > input');
            const PasswordLoginField = document.querySelector('#login > div:nth-child(3) > input');
            const TermsLogin = document.querySelector('#TermOfUseLogin');
            const RequireLabelLogin = document.querySelector('#login > div.input-class.required-all-fields.display-none');

         
            EmailLoginField.addEventListener("keyup",()=>{
                EmailLoginField.classList.remove("require")
                RequireLabelLogin.innerHTML = ""
            })

            PasswordLoginField.addEventListener("keyup",()=>{
                PasswordLoginField.classList.remove("require")
                RequireLabelLogin.innerHTML = ""
            })

            TermsLogin.addEventListener("click",()=>{
                if(EmailLoginField.value === "" || PasswordLoginField.value === ""){
                    Validate()
                }
            })

            LoginButton.addEventListener("click",()=>{
                if(Validate() === true){
                    console.log(localDB.hasOwnProperty(EmailLoginField.value));
                    if(localDB.hasOwnProperty(EmailLoginField.value)){
                        let getUser = localDB.getItem(EmailLoginField.value)
                        let Data = JSON.parse(getUser)
                        console.log(Data)
                        console.log(Data.Password)
                        console.log(PasswordLoginField.value)
                        if(Data.Password === PasswordLoginField.value){

                            RequireLabelLogin.innerHTML = "<p>Login Here!</p>"
                            sessionDB.setItem("user",Data.Email);
                            SessionUser(Data.Email);

                        }else{
                            RequireLabelLogin.innerHTML = "<p>Wrong Password!</p>"
                        }
                    }else{
                        RequireLabelLogin.innerHTML = "<p>Cannot find email address!</p>"
                    }
                }
            })
               
            function Validate(){
                if(EmailLoginField.value === "" || PasswordLoginField.value === ""){
                    if(EmailLoginField.value === ""){
                        EmailLoginField.classList.add("require")
                        RequireLabelLogin.classList.remove("display-none")
                        RequireLabelLogin.innerHTML = "<p>All fields are required</p>"
                    }
                    if (PasswordLoginField.value === ""){
                        PasswordLoginField.classList.add("require");
                        RequireLabelLogin.classList.remove("display-none")
                        RequireLabelLogin.innerHTML = "<p>All fields are required</p>"
                    }
                    return false
                }else{
                    if(TermsLogin.checked === true){
                        RequireLabelLogin.innerHTML = "<p>Looks Good!</p>"
                        RequireLabelLogin.classList.remove("display-none")
                        return true
                    }else{
                        RequireLabelLogin.classList.remove("display-none")
                        RequireLabelLogin.innerHTML = "<p>Terms of Use is required</p>"
                        return false
                    }
                }
            }


            function SessionUser(UserEmail){
                if(sessionDB.hasOwnProperty("user")){
                    LogInForm.classList.add("display-none")
                    SingInForm.classList.add("display-none")
                    Intro.classList.add("display-none");
                    dashboard.classList.remove("display-none");
                    LoginButton.classList.add("display-none");
                    SignInButton.classList.add("display-none");
                    BackButton.classList.add("display-none");
                }
            }
            SessionUser();
            const LogOut = document.querySelector("#dashboardID > div.side-bar > a:nth-child(3)");
            LogOut.addEventListener("click",()=>{
                sessionDB.removeItem("user");
            })

            const getCreateList = document.getElementById("create-list");   

            let GetUserSession = sessionDB.getItem("user")
            console.log(GetUserSession)

            let GetSessionData = localDB.getItem(GetUserSession);
            let LogedInUser = JSON.parse(GetSessionData)

            if(LogedInUser.TodoList.length === 0){
                getCreateList.classList.add("display-none")
            }
            const CreateTodoListBtn = document.querySelector("#no-list > button");
            const NoList = document.querySelector("#no-list");
            
            const ListTitleInput = document.querySelector("#create-list > input:nth-child(1)");
            const ListInput = document.querySelector("#create-list > input:nth-child(4)");
            const AddList  = document.querySelector("#add");
            const SubmitListBTN = document.querySelector("#submit-todolist");
            const UL = document.querySelector("#create-list > ul");
            const TitleList = document.querySelector("#create-list > h3");
            
            CreateTodoListBtn.addEventListener("click",CreateTodoListForm)

            function CreateTodoListForm() {
                NoList.classList.add("display-none")
                getCreateList.classList.remove("display-none");
                ListInput.classList.add("display-none");
                SubmitListBTN.classList.add("display-none");
            }

            ListTitleInput.addEventListener("keyup",()=>{
                TitleList.innerText = ListTitleInput.value
                
            })
            AddList.addEventListener("click",ListAdd);

            function ListAdd () {
                if(TitleList.innerText === ""){
                    
                    ListTitleInput.classList.add("require");
                }else{
                    AddList.innerText="Add List"
                    ListTitleInput.classList.add("display-none");
                    ListInput.classList.remove("display-none");
                    SubmitListBTN.classList.remove("display-none");

                    if(ListInput.value === ""){
                        console.log("List input cannot be empty");

                    }else{
                        console.log(document.getElementsByTagName("li").length)
                        var createLI = document.createElement("li");
                        createLI.innerText = ListInput.value;
                        UL.appendChild(createLI)
                        ListInput.value=""
                    }

                }
            }

    </script>
</html>